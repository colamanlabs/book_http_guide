# HTTP 완벽 가이드
```
알라딘 ebook 구매
```

```
2024.05.01
20240501_0008.md
```

## 15장 엔터티와 인코딩


### 15.1 메시지는 컨테이너, 엔터티는 화물

https://www.popit.kr/wp-content/uploads/2023/02/Untitled-1-600x194.png

```
메시지 엔터티는 엔터티 헤더와 엔터티 본문으로 이루어진다.
```


#### 15.1.1 엔터티 본문
```
엔터티 본문은 가공되지 않은 데이터만을 담고 있다.
다른 정보들은 모두 헤더에 담겨 있다.
엔터티 본문은 가공되지 않은 날 데이터에 불과하기 때문에 엔터티 허더는 그 데이터의 의미에 대해 설명할 필요가 있다.
예를 들어 Content-Type 엔터티 헤더는 우리에게 그 데이터를 어떻게 해석해야 하는지 말해주며,
Content-Encoding 헤더는 우리에게 그 데이터가 압축되었거나, 혹은 추가적인 인코딩이 되었는지 말해준다.

엔터티 본문은 헤더 필드의 끝을 의마하는 빈 CRLF 줄 바로 다음부터 시작한다.
```

### 15.2 Content-Length: 엔터티의 길이
```
Content-Length 헤더는 메시지의 엔터티 본문의 크기를 바이트 단위로 나타낸다.
Content-Length 해도눈 매시지를 청크 인코딩으로 전송하지 않는 이상, 
엔터티 본문을 포함한 메시지에서는 필수적으로 있어야 한다.

Content-Length는 서버충돌로 인해 메시지가 잘렸는지 감지하고자 할 떄와, 
지속 커넥션을 공유하는 메세지를 올바르게 분할하고자 할 때 필요하다.
```


### 15.4 미디어 타입과 차셋(Charset)
|미디어타입|설명|
|-|-|
|... | ... |
|multipart/byteranges| 엔터티 본문은 여러부분으로 나뉘는데, 각 부분은 전체문서의 특정범위(바이트 단위)를 담고 있다.
|... | ... |


#### 15.4.1 텍스트 매체를 위한 문자 인코딩

```
Content-Type: text/html; charset=iso-8859-4
```

#### 15.4.2 멀티파트 미디어 타입

```
MIME "멀티파트" 이메일 메세지는 서로 붙어있는 여러개의 메시지를 포함하며,
하나의 복합 메시지로 보내진다.
HTTP 는 멀티파트 본문도 지원한다.
그러나, 일반적으로는 폼을 채워서 제출할 떄와, 
문서의 일부분을 실어 나르는 범위응답을 할 때의 두가지 경우에만 사용된다.
```

#### 15.4.3 멀티파트 폼 제출 

```
...
HTTP 는 그러한 요청을 Content-Type: multipart/form-data 나 Content-Type: multipart/mixed 헤더에
멀티파트 본문을 함께 보낸다.

Content-Type: multipart/form-data; bouindary=[abcdefghi...xyz]

이때 boundary 는 본문의 서로 다른 부분을 구분하기 위한 구분자로 쓰인다.
```

#### 15.4.4 멀티파트 범위 응답


### 15.5 콘텐츠 인코딩 

https://velog.velcdn.com/images/bahar-j/post/44f1fe04-c37a-4753-9935-4be28a3892da/image.png

```
콘텐츠 인코딩된 메세지는 단지 메시지의 엔터티 부분만 인코딩 한다.
전송 인코딩된 메시지에서는, 인코딩은 전체 메시지에 대해 적용되어 메시지 자체의 구조를 바꾼다.
```


#### 15.6.3 청크 인코딩 

```
청크 인코딩은 메세지를 일정 크기의 청크 여럿으로 쪼갠다.
서버는 각 청크를 순차적으로 보낸다.
청크 인코딩을 이용하면 메세지를 보내기 전에 전체 크기를 알 필요가 없어진다.
본문이 동적으로 생성됨에 따라, 
서버는 그중 일부를 버퍼에 담은 뒤 그 한 청크를 그것의 크기와 함께 보낼 수 있다.
본문 전체를 모두 보낼 때까지 이 단계를 반복한다.
```
https://velog.velcdn.com/images/bahar-j/post/5306900c-10c1-4052-8e89-01a41b2a0670/image.png

```
각 청크는 길이 값(hex) 과 각 청크에 대한 데이터를 담고 있다.
길이 값은 16진수 형식으로 되어 있고ㅓ, 청크 데이터와 CRLF 로 분리된다.

청크 데이터의 길이는 바이트 단위로 측정되고, 청크 끝의 CRLF 문자열 뿐만 아니라, 
길이값과 데이터 사이의 CRLF 문자열도 포함하지 않는다.
마지막 청크는 특별하다. 그것은 본문의 끝을 의미하기 위해 길이가 0 이다.
```


#  끝 ( page 390 )

